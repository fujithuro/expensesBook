# 概要

自分用の家計簿アプリケーション。

出費を1件ずつ登録していき、月ごとに出費の一覧や合計金額を確認できるようにする。費目ごとの絞り込みにも対応する。

## Front-End

React（Next.js）でフロントエンドを作成する予定

詳細は、Issue #2 フロントエンドの作成 に記載

## Server-Side

### REST API

家計簿に対して出費の追加/更新/削除を行ったり、一覧の取得を行ったりするREST APIを提供する

#### 出費一覧の取得

* 概要: 家計簿に登録済みされている特定の年月の出費一覧を取得する。費目での絞り込みも可能
* URL: /api/expenseBook/list/{yyyyMM}
* メソッド: `GET`

###### パスパラメータ

| name   | required | value              |
|--------|----------|--------------------|
| yyyyMM | ◯        | 取得する出費の年月。yyyyMM形式 |

###### クエリパラメータ

| name | required | value                                                    |
|------|----------|----------------------------------------------------------|
| type |          | 絞り込む費目をコードで指定する。複数指定可能。指定されなければ全て取得する。コードの詳細は「その他補足事項」参照 |

##### レスポンス

* `200 OK`: 出費のリストを返します

###### レスポンスボディ

Content-Type: `application/json`

```json
[
  {
    "id": "5bcfeb53-6961-475a-b10a-8bbd644993d9",
    "date": "2024-07-12",
    "price": 1800,
    "store": "スーパーマーケット",
    "usage": "食料品",
    "type": 1
  },
  {
    "id": "2e24a6b2-0f57-469b-9a9b-d02755c8f217",
    "date": "2024-07-13",
    "price": 5000,
    "store": "レストラン",
    "usage": "夕食",
    "type": 2
  }
]
```

#### 出費の詳細を取得

* URL: /api/expenseBook/detail/{id}
* メソッド: `GET`
* 概要: 家計簿に登録済みされている出費の詳細を取得する

###### パスパラメータ

| name | required | value     |
|------|----------|-----------|
| id   | ◯        | 取得する出費のid |

##### レスポンス

* `200 OK`: 出費の詳細を返します

Content-Type: `application/json`

```json
{
  "id": "5bcfeb53-6961-475a-b10a-8bbd644993d9",
  "date": "2024-07-12",
  "price": 1800,
  "store": "スーパーマーケット",
  "usage": "食料品",
  "type": 1
}
```

* `404 Not Found`: 指定された出費が存在しませんでした

#### 出費の追加

* URL: /api/expenseBook
* メソッド: `POST`
* 概要: 出費1件を家計簿に登録する

##### リクエスト

###### リクエストボディ

Content-Type: `application/json`

| name | required | value                |
|------|----------|----------------------|
| date    | ◯        | 出費の日付                |
| price    | ◯        | 出費金額。マイナスも可          |
| store    |          | 支払先                  |
| usage    |          | 使途                   |
| type    | ◯        | 費目のコード。詳細は「その他補足事項」参照 |

e.g.

```json
{
  "date": "2024-07-12",
  "price": 1000,
  "store": "スーパーマーケット",
  "usage": "食料品",
  "type": 1
}
```

##### レスポンス

* `201 Created`: 出費が正常に登録されました

Content-Type: `application/json`

```json
{
  "id": "5bcfeb53-6961-475a-b10a-8bbd644993d9",
  "date": "2024-07-12",
  "price": 1000,
  "store": "スーパーマーケット",
  "usage": "食料品",
  "type": 1
}
```

#### 出費の更新

* URL: /api/expenseBook/{id}
* メソッド: `PUT`
* 概要: 家計簿に登録済みの出費1件を更新する

##### リクエスト

###### パスパラメータ

| name | required | value     |
|------|----------|-----------|
| id   | ◯        | 更新する出費のid |

###### リクエストボディ

Content-Type: `application/json`

| name | required | value                     |
|------|----------|---------------------------|
| date    | ◯        | 出費の日付                     |
| price    | ◯        | 出費金額。マイナスも可               |
| store    |          | 支払先                       |
| usage    |          | 使途                        |
| type    | ◯        | 費目のコード。コードの詳細は「その他補足事項」参照 |

e.g.

```json
{
  "id": "5bcfeb53-6961-475a-b10a-8bbd644993d9",
  "date": "2024-07-12",
  "price": 1800,
  "store": "スーパーマーケット",
  "usage": "食料品",
  "type": 1
}
```

##### レスポンス

* `204 No Content`: 更新が正常に反映されました

Content-Type: `application/json`

```json
{
  "id": "5bcfeb53-6961-475a-b10a-8bbd644993d9",
  "date": "2024-07-12",
  "price": 1800,
  "store": "スーパーマーケット",
  "usage": "食料品",
  "type": 1
}
```

* `404 Not Found`: 指定された出費が存在しませんでした


#### 出費の削除

* URL: /api/expenseBook/{id}
* メソッド: `DELETE`
* 概要: 家計簿に登録済みの出費1件を削除する

##### リクエスト

###### パスパラメータ

| name | required | value     |
|------|----------|-----------|
| id   | ◯        | 更新する出費のid |

##### レスポンス

* `204 No Content`: 削除が正常に実行されました

* `404 Not Found`: 指定された出費が存在しませんでした


### その他補足事項

#### 費目コード

リクエストで指定できる費目のコード一覧

| コード | 費目            |
|-----|---------------|
| 1   | 食費・雑費（スーパーなど） |
| 2   | 食費・雑費（外食など）   |
| 3   | 娯楽            |
| 4   | 身だしなみ         |
| 5   | ガソリン          |
| 6   | 設備            |
| 7   | 学習            |
| 8   | 医療            |
| 9   | その他           |


### DB

#### 出費履歴

| name   | type      | PK | not null | default           | description      |
|--------|-----------|----|----------|-------------------|------------------|
| id     | uuid      | ◯  | ◯        | gen_random_uuid() | 出費を一意にするid       |
| 支払日    | date      |    | ◯        |                   | 支払った日付           |
| 費目cd   | integer   |    | ◯        |                   | 費目マスターの費目cd      |
| 金額     | integer   |    | ◯        |                   | 支払った金額。マイナスも許容する |
| 支払先    | text      |    | ◯        |                   | 支払先              |
| 使途     | text      |    | ◯        |                   | 購入した物品や受けたサービス内容 |
| 最終更新日時 | timestamp |    | ◯        | CURRENT_TIMESTAMP | 出費を最後に更新した日時     |


#### 費目マスター
| name   | type      | PK | not null | default | description                 |
|--------|-----------|----|----------|---------|-----------------------------|
| 費目cd   | integer   | ◯  | ◯        |         | 費目を一意にするコード                 |
| 費目名    | text      |    | ◯        |         | 費目の名称                       |
| 有効区分   | boolean   |    | ◯        | true    | 費目の有効区分。無効の場合、新規登録で選択できなくなる |

[//]: # (TODO とりあえず最低限必要そうな情報だけで定義している。)
[//]: # (TODO できれば、複数人利用や不正利用対策などで、`登録者`)
